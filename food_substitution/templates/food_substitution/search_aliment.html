{% extends 'base.html' %}
{% load static %}
{% block content %}
<!--Search products-->
<section class='page-section bg-info' id='all_aliments'>
    <div class='container-fluid px-5' style='min-height:65%;'>
        <div class='row'>
            {% if lenproducts == '601'%}
                <div class='col-lg-812 text-primary text-center'>
                    <h2 class='my-5'>Oups !<br> Veuillez remplir ce champ avant de valider la recherche.</h2>
                    <div class='input-group justify-content-center p-2'>
                        <form action='{% url "user_search" %}' method='get'>
                            <input type='search' 
                                name='query' 
                                class='border rounded align-middle m-0' 
                                placeholder='Produit' 
                                style='background-color:#EEE; height: 100%' 
                                aria-label='Search' 
                                aria-describedby='search-addon' />
                            <button type='submit' 
                                    class='btn btn-primary btn-block align-middle m-0'>Chercher</button>
                        </form>
                    </div>
                </div>
            {% elif lenproducts == '0' %}
                <div class='col-lg-812 text-primary text-center'>
                    <h2 class='my-5'>Désolé !<br> Aucun produit ne correspond à votre recherche.</h2>
                    <div class='input-group justify-content-center p-2'>
                        <form action='{% url "user_search" %}' method='get'>
                            <input type='search' 
                                name='query' 
                                class='border rounded align-middle m-0' 
                                placeholder='Produit' 
                                style='background-color:#EEE; height: 100%' 
                                aria-label='Search' 
                                aria-describedby='search-addon' />
                            <button type='submit' 
                                    class='btn btn-primary btn-block align-middle m-0'>Chercher</button>
                        </form>
                    </div>
                </div>
            {% else %}
                {% for element in products %}
                    <div class='col-xl-4 p-4'>
                        <div class='d-flex justify-content-end'>
                            <img src="{% static 'assets/img/'|add:element.nustriscore|add:'.png' %}"
                                class=''
                                style='margin-right:30%; width:65px; height:auto;'
                                alt=''>
                        </div>
                        <div class='p-3' style='height: 250px; text-align: center'>
                            <img src='{{ element.image }}'
                                class='rounded'
                                style='max-height: 100%; max-width:100% ;width: auto;'
                                alt='...' title='{{ element }}-image'>
                        </div>
                        <div class='' style='height:150px'>
                            <a href="{% url 'product_page' element.id %}" style='text-decoration: none;'>
                                <h1 class='text-center text-primary' style='font-size: 22px;'>{{ element }}</h1>
                            </a>
                            {% if user.is_authenticated %}
                                <div class='d-flex justify-content-center text-primary'>
                                    {% if element.id in favorites_id_list %}
                                        <i class='fa fa-floppy-o p-1'></i>
                                        <p class='align-top pt-0'>Déja enregistré</p>
                                    {% else %}
                                        <i class='fa-regular fa-square-full pt-2'></i>
                                        <form action="" method='get'>
                                            {% csrf_token %}
                                            <input type='submit' value='Enregistrer' class='btn btn-info p-0 text-primary'>
                                            <input type='hidden' id='prodId' name='prodId' value='{{element.id}}'>
                                            <input type='hidden' id='query' name='query' value='{{query}}'>
                                        </form>
                                    {% endif %}
                                </div>
                            {% endif %}
                        </div>
                    </div>
                {% endfor %}
            {% endif %}
        </div>
    </div>
</section>
{% endblock %}